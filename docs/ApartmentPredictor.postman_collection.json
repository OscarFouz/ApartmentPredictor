===== ESTRUCTURA DEL PROYECTO (sin tests) =====


===== CÃ“DIGO FUENTE (.java) =====

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/controller/ReviewController.java
----------------------------------------
package com.example.apartment_predictor.controller;

import com.example.apartment_predictor.model.Property;
import com.example.apartment_predictor.model.Review;
import com.example.apartment_predictor.repository.ReviewRepository;
import com.example.apartment_predictor.service.PropertyService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.net.URI;

@RestController
@RequestMapping("/api/reviews")
@CrossOrigin(origins = "http://localhost:5173")
public class ReviewController {

    @Autowired
    private ReviewRepository reviewRepository;

    @Autowired
    private PropertyService propertyService;

    // ============================
    // GET REVIEWS BY PROPERTY
    // ============================
    @GetMapping("/property/{id}")
    public ResponseEntity<?> getReviewsByProperty(@PathVariable String id) {

        Property property = propertyService.findById(id);

        if (property == null) {
            return ResponseEntity.notFound().build();
        }

        return ResponseEntity.ok(property.getReviews());
    }

    // ============================
    // CREATE REVIEW
    // ============================
    @PostMapping("/property/{id}")
    public ResponseEntity<Review> addReview(
            @PathVariable String id,
            @RequestBody Review review) {

        Property property = propertyService.findById(id);

        if (property == null) {
            return ResponseEntity.notFound().build();
        }

        review.setProperty(property);
        Review saved = reviewRepository.save(review);

        return ResponseEntity
                .created(URI.create("/api/reviews/" + saved.getId()))
                .body(saved);
    }

    // ============================
    // DELETE REVIEW
    // ============================
    @DeleteMapping("/{reviewId}")
    public ResponseEntity<Void> deleteReview(@PathVariable String reviewId) {

        if (!reviewRepository.existsById(reviewId)) {
            return ResponseEntity.notFound().build();
        }

        reviewRepository.deleteById(reviewId);
        return ResponseEntity.noContent().build();
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/controller/ReviewerController.java
----------------------------------------
package com.example.apartment_predictor.controller;

import com.example.apartment_predictor.model.Reviewer;
import com.example.apartment_predictor.service.ReviewerService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/reviewers")
@CrossOrigin(origins = "http://localhost:5173")
public class ReviewerController {

    @Autowired
    private ReviewerService reviewerService;

    // ============================
    // GET ALL
    // ============================
    @GetMapping
    public Iterable<Reviewer> getAll() {
        return reviewerService.findAll();
    }

    // ============================
    // GET BY ID
    // ============================
    @GetMapping("/{id}")
    public ResponseEntity<Reviewer> getById(@PathVariable String id) {

        Reviewer r = reviewerService.findReviewerById(id);
        return r != null ? ResponseEntity.ok(r) : ResponseEntity.notFound().build();
    }

    // ============================
    // CREATE
    // ============================
    @PostMapping
    public Reviewer create(@RequestBody Reviewer reviewer) {
        return reviewerService.updateReviewer(reviewer);
    }

    // ============================
    // UPDATE
    // ============================
    @PutMapping("/{id}")
    public ResponseEntity<Reviewer> update(@PathVariable String id, @RequestBody Reviewer reviewer) {

        Reviewer updated = reviewerService.updateReviewerById(id, reviewer);
        return updated != null ? ResponseEntity.ok(updated) : ResponseEntity.notFound().build();
    }

    // ============================
    // DELETE
    // ============================
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> delete(@PathVariable String id) {

        reviewerService.deleteReviewer(id);
        return ResponseEntity.noContent().build();
    }

    // ============================
    // GET REVIEWS OF REVIEWER
    // ============================
    @GetMapping("/{id}/reviews")
    public ResponseEntity<?> getReviewerReviews(@PathVariable String id) {

        Reviewer reviewer = reviewerService.findReviewerById(id);
        return reviewer != null ? ResponseEntity.ok(reviewer.getReviews()) : ResponseEntity.notFound().build();
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/controller/PropertyContractController.java
----------------------------------------
package com.example.apartment_predictor.controller;

import com.example.apartment_predictor.model.PropertyContract;
import com.example.apartment_predictor.service.PropertyContractService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpHeaders;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/contracts")
@CrossOrigin(origins = "http://localhost:5173")
public class PropertyContractController {

    @Autowired
    private PropertyContractService contractService;

    // ============================
    // GET ALL
    // ============================
    @GetMapping
    public ResponseEntity<Iterable<PropertyContract>> getAll() {

        HttpHeaders headers = new HttpHeaders();
        headers.add("Status", "getAllContracts executed");
        headers.add("version", "1.0");
        headers.add("author", "Big");

        return ResponseEntity.ok().headers(headers).body(contractService.findAll());
    }

    // ============================
    // GET BY ID
    // ============================
    @GetMapping("/{id}")
    public ResponseEntity<PropertyContract> getById(@PathVariable String id) {

        return contractService.findById(id)
                .map(ResponseEntity::ok)
                .orElse(ResponseEntity.notFound().build());
    }

    // ============================
    // CREATE
    // ============================
    @PostMapping
    public ResponseEntity<PropertyContract> create(@RequestBody PropertyContract contract) {

        HttpHeaders headers = new HttpHeaders();
        headers.add("Status", "createContract executed");

        if (contract.getOwner() == null || contract.getProperty() == null) {
            headers.add("Error", "Owner or Property missing");
            return ResponseEntity.badRequest().headers(headers).body(null);
        }

        PropertyContract created = contractService.createContract(
                contract.getOwner(),
                contract.getProperty(),
                contract.getAgreedPrice()
        );

        return ResponseEntity.ok().headers(headers).body(created);
    }

    // ============================
    // CLOSE CONTRACT
    // ============================
    @PutMapping("/{id}/close")
    public ResponseEntity<PropertyContract> closeContract(@PathVariable String id) {

        HttpHeaders headers = new HttpHeaders();
        headers.add("Status", "closeContract executed");

        PropertyContract closed = contractService.closeContract(id);

        if (closed == null) {
            headers.add("Error", "Contract not found");
            return ResponseEntity.notFound().headers(headers).build();
        }

        return ResponseEntity.ok().headers(headers).body(closed);
    }

    // ============================
    // DELETE
    // ============================
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> delete(@PathVariable String id) {

        HttpHeaders headers = new HttpHeaders();
        headers.add("Status", "deleteContract executed");

        if (contractService.findById(id).isEmpty()) {
            headers.add("Error", "Contract not found");
            return ResponseEntity.notFound().headers(headers).build();
        }

        contractService.deleteContract(id);
        return ResponseEntity.noContent().headers(headers).build();
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/controller/TownHouseController.java
----------------------------------------
package com.example.apartment_predictor.controller;

import com.example.apartment_predictor.model.TownHouse;
import com.example.apartment_predictor.service.TownHouseService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/townhouses")
@CrossOrigin(origins = "http://localhost:5173")
public class TownHouseController {

    @Autowired
    private TownHouseService townHouseService;

    // ============================
    // GET ALL
    // ============================
    @GetMapping
    public Iterable<TownHouse> getAll() {
        return townHouseService.findAll();
    }

    // ============================
    // GET BY ID
    // ============================
    @GetMapping("/{id}")
    public ResponseEntity<TownHouse> getById(@PathVariable String id) {

        TownHouse t = townHouseService.findTownHouseById(id);
        return t != null ? ResponseEntity.ok(t) : ResponseEntity.notFound().build();
    }

    // ============================
    // CREATE
    // ============================
    @PostMapping
    public TownHouse create(@RequestBody TownHouse townHouse) {
        return townHouseService.updateTownHouse(townHouse);
    }

    // ============================
    // UPDATE
    // ============================
    @PutMapping("/{id}")
    public ResponseEntity<TownHouse> update(@PathVariable String id, @RequestBody TownHouse townHouse) {

        TownHouse updated = townHouseService.updateTownHouseById(id, townHouse);
        return updated != null ? ResponseEntity.ok(updated) : ResponseEntity.notFound().build();
    }

    // ============================
    // DELETE
    // ============================
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> delete(@PathVariable String id) {

        townHouseService.deleteTownHouse(id);
        return ResponseEntity.noContent().build();
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/controller/HouseController.java
----------------------------------------
package com.example.apartment_predictor.controller;

import com.example.apartment_predictor.model.House;
import com.example.apartment_predictor.service.HouseService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpHeaders;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/houses")
@CrossOrigin(origins = "http://localhost:5173")
public class HouseController {

    @Autowired
    private HouseService houseService;

    // ============================
    // GET ALL
    // ============================
    @GetMapping
    public ResponseEntity<Iterable<House>> getAll() {

        HttpHeaders headers = new HttpHeaders();
        headers.add("Status", "getAllHouses executed");

        return ResponseEntity.ok().headers(headers).body(houseService.findAll());
    }

    // ============================
    // GET BY ID
    // ============================
    @GetMapping("/{id}")
    public ResponseEntity<House> getById(@PathVariable String id) {

        House h = houseService.findHouseById(id);
        return h != null ? ResponseEntity.ok(h) : ResponseEntity.notFound().build();
    }

    // ============================
    // CREATE
    // ============================
    @PostMapping
    public ResponseEntity<House> create(@RequestBody House house) {

        House created = houseService.updateHouse(house);
        return ResponseEntity.ok(created);
    }

    // ============================
    // UPDATE
    // ============================
    @PutMapping("/{id}")
    public ResponseEntity<House> update(@PathVariable String id, @RequestBody House house) {

        House updated = houseService.updateHouseById(id, house);
        return updated != null ? ResponseEntity.ok(updated) : ResponseEntity.notFound().build();
    }

    // ============================
    // DELETE
    // ============================
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> delete(@PathVariable String id) {

        houseService.deleteHouse(id);
        return ResponseEntity.noContent().build();
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/controller/PopulateDBController.java
----------------------------------------
package com.example.apartment_predictor.controller;

import com.example.apartment_predictor.utils.PopulateDB;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpHeaders;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/v1/populate")
@CrossOrigin(origins = "http://localhost:5173")
public class PopulateDBController {

    @Autowired
    private PopulateDB populateDB;

    // ============================
    // POPULATE FULL DATABASE
    // ============================
    @GetMapping
    public ResponseEntity<String> populate(
            @RequestParam(defaultValue = "10") int owners,
            @RequestParam(defaultValue = "50") int properties,
            @RequestParam(defaultValue = "100") int reviews,
            @RequestParam(defaultValue = "20") int schools
    ) {

        HttpHeaders headers = new HttpHeaders();
        headers.add("Status", "populate executed");
        headers.add("version", "1.0");
        headers.add("author", "Big");

        // ============================
        // ORCHESTRATOR CALL
        // ============================
        int result = populateDB.populateAll(owners, properties, reviews, schools);

        // ============================
        // CONTROL: BD YA POBLADA
        // ============================
        if (result == -1) {
            headers.add("Error", "Database already populated");
            return ResponseEntity
                    .status(409) // Conflict
                    .headers(headers)
                    .body("Database already populated. Populate aborted.");
        }

        // ============================
        // SUCCESS
        // ============================
        headers.add("Status", "populate success");
        return ResponseEntity.ok()
                .headers(headers)
                .body("Database populated successfully. Total created: " + result);
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/controller/ApartmentController.java
----------------------------------------
package com.example.apartment_predictor.controller;

import com.example.apartment_predictor.model.Apartment;
import com.example.apartment_predictor.model.School;
import com.example.apartment_predictor.repository.SchoolRepository;
import com.example.apartment_predictor.service.ApartmentService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpHeaders;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.*;
import java.util.stream.Collectors;
import java.util.stream.StreamSupport;

@RestController
@RequestMapping("/api/apartments")
@CrossOrigin(origins = "http://localhost:5173")
public class ApartmentController {

    @Autowired
    private ApartmentService apartmentService;

    @Autowired
    private SchoolRepository schoolRepository;

    // ============================
    // GET ALL
    // ============================
    @GetMapping
    public ResponseEntity<Iterable<Apartment>> getAll() {

        HttpHeaders headers = new HttpHeaders();
        headers.add("Status", "getAllApartments executed");
        headers.add("version", "2.0");
        headers.add("active", "true");
        headers.add("author", "Oscar");

        return ResponseEntity.ok().headers(headers).body(apartmentService.findAll());
    }

    // ============================
    // GET BY ID
    // ============================
    @GetMapping("/{id}")
    public ResponseEntity<Apartment> getById(@PathVariable String id) {

        Apartment apt = apartmentService.findApartmentById(id);
        return apt != null ? ResponseEntity.ok(apt) : ResponseEntity.notFound().build();
    }

    // ============================
    // CREATE
    // ============================
    @PostMapping
    public ResponseEntity<Apartment> create(@RequestBody Apartment apartment) {

        Apartment created = apartmentService.createApartment(apartment);
        return ResponseEntity.ok(created);
    }

    // ============================
    // UPDATE
    // ============================
    @PutMapping("/{id}")
    public ResponseEntity<Apartment> update(
            @PathVariable String id,
            @RequestBody Apartment apartment) {

        Apartment updated = apartmentService.updateApartmentById(id, apartment);
        return updated != null ? ResponseEntity.ok(updated) : ResponseEntity.notFound().build();
    }

    // ============================
    // DELETE
    // ============================
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> delete(@PathVariable String id) {

        Apartment apt = apartmentService.findApartmentById(id);
        if (apt == null) return ResponseEntity.notFound().build();

        apartmentService.deleteApartment(id);
        return ResponseEntity.noContent().build();
    }

    // ============================
    // ASSIGN SCHOOLS
    // ============================
    @PutMapping("/{id}/assign-schools")
    public ResponseEntity<Apartment> assignSchools(
            @PathVariable String id,
            @RequestBody List<String> schoolIds) {

        HttpHeaders headers = new HttpHeaders();
        headers.add("Status", "assignSchools executed");
        headers.add("version", "2.0");
        headers.add("author", "Oscar");

        Apartment apartment = apartmentService.findApartmentById(id);
        if (apartment == null) {
            headers.add("Error", "Apartment not found");
            return ResponseEntity.badRequest().headers(headers).body(null);
        }

        Iterable<School> found = schoolRepository.findAllById(schoolIds);
        List<School> schoolsFound = StreamSupport.stream(found.spliterator(), false)
                .filter(Objects::nonNull)
                .collect(Collectors.toList());

        if (schoolsFound.size() != schoolIds.size()) {
            headers.add("Error", "Some schools not found");
            return ResponseEntity.badRequest().headers(headers).body(null);
        }

        apartment.setNearbySchools(schoolsFound);
        Apartment saved = apartmentService.updateApartment(apartment);

        headers.add("Status", "assignSchools success");
        return ResponseEntity.ok().headers(headers).body(saved);
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/controller/OwnerController.java
----------------------------------------
package com.example.apartment_predictor.controller;

import com.example.apartment_predictor.model.Owner;
import com.example.apartment_predictor.service.OwnerService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/owners")
@CrossOrigin(origins = "http://localhost:5173")
public class OwnerController {

    @Autowired
    private OwnerService ownerService;

    // ============================
    // GET ALL
    // ============================
    @GetMapping
    public Iterable<Owner> getAll() {
        return ownerService.findAll();
    }

    // ============================
    // GET BY ID
    // ============================
    @GetMapping("/{id}")
    public ResponseEntity<Owner> getById(@PathVariable String id) {

        Owner o = ownerService.findOwnerById(id);
        return o != null ? ResponseEntity.ok(o) : ResponseEntity.notFound().build();
    }

    // ============================
    // CREATE
    // ============================
    @PostMapping
    public Owner create(@RequestBody Owner owner) {
        return ownerService.updateOwner(owner);
    }

    // ============================
    // UPDATE
    // ============================
    @PutMapping("/{id}")
    public ResponseEntity<Owner> update(@PathVariable String id, @RequestBody Owner owner) {

        Owner updated = ownerService.updateOwnerById(id, owner);
        return updated != null ? ResponseEntity.ok(updated) : ResponseEntity.notFound().build();
    }

    // ============================
    // DELETE
    // ============================
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> delete(@PathVariable String id) {

        ownerService.deleteOwner(id);
        return ResponseEntity.noContent().build();
    }

    // ============================
    // RELACIONES
    // ============================
    @GetMapping("/{id}/houses")
    public ResponseEntity<?> getOwnerHouses(@PathVariable String id) {

        Owner owner = ownerService.findOwnerById(id);
        return owner != null ? ResponseEntity.ok(owner.getHouses()) : ResponseEntity.notFound().build();
    }

    @GetMapping("/{id}/duplexes")
    public ResponseEntity<?> getOwnerDuplexes(@PathVariable String id) {

        Owner owner = ownerService.findOwnerById(id);
        return owner != null ? ResponseEntity.ok(owner.getDuplexes()) : ResponseEntity.notFound().build();
    }

    @GetMapping("/{id}/townhouses")
    public ResponseEntity<?> getOwnerTownHouses(@PathVariable String id) {

        Owner owner = ownerService.findOwnerById(id);
        return owner != null ? ResponseEntity.ok(owner.getTownHouses()) : ResponseEntity.notFound().build();
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/controller/DuplexController.java
----------------------------------------
package com.example.apartment_predictor.controller;

import com.example.apartment_predictor.model.Duplex;
import com.example.apartment_predictor.service.DuplexService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/duplexes")
@CrossOrigin(origins = "http://localhost:5173")
public class DuplexController {

    @Autowired
    private DuplexService duplexService;

    // ============================
    // GET ALL
    // ============================
    @GetMapping
    public Iterable<Duplex> getAll() {
        return duplexService.findAll();
    }

    // ============================
    // GET BY ID
    // ============================
    @GetMapping("/{id}")
    public ResponseEntity<Duplex> getById(@PathVariable String id) {

        Duplex d = duplexService.findDuplexById(id);
        return d != null ? ResponseEntity.ok(d) : ResponseEntity.notFound().build();
    }

    // ============================
    // CREATE
    // ============================
    @PostMapping
    public Duplex create(@RequestBody Duplex duplex) {
        return duplexService.updateDuplex(duplex);
    }

    // ============================
    // UPDATE
    // ============================
    @PutMapping("/{id}")
    public ResponseEntity<Duplex> update(@PathVariable String id, @RequestBody Duplex duplex) {

        Duplex updated = duplexService.updateDuplexById(id, duplex);
        return updated != null ? ResponseEntity.ok(updated) : ResponseEntity.notFound().build();
    }

    // ============================
    // DELETE
    // ============================
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> delete(@PathVariable String id) {

        duplexService.deleteDuplex(id);
        return ResponseEntity.noContent().build();
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/ApartmentPredictorApplication.java
----------------------------------------
package com.example.apartment_predictor;

import com.example.apartment_predictor.repository.*;
import com.example.apartment_predictor.utils.PopulateDB;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

import jakarta.annotation.PostConstruct;
import org.springframework.beans.factory.annotation.Autowired;

@SpringBootApplication
public class ApartmentPredictorApplication {

    @Value("${app.populate-on-start:false}")
    private boolean populateOnStart;

    @Autowired private OwnerRepository ownerRepository;
    @Autowired private ApartmentRepository apartmentRepository;
    @Autowired private HouseRepository houseRepository;
    @Autowired private DuplexRepository duplexRepository;
    @Autowired private TownHouseRepository townHouseRepository;
    @Autowired private SchoolRepository schoolRepository;
    @Autowired private ReviewerRepository reviewerRepository;
    @Autowired private ReviewRepository reviewRepository;

    @Autowired
    private PopulateDB populateDB;

    public static void main(String[] args) {
        SpringApplication.run(ApartmentPredictorApplication.class, args);
    }

    @PostConstruct
    public void init() {

        if (!populateOnStart) {
            System.out.println("Populate on start disabled.");
            return;
        }

        System.out.println("Checking if database is empty...");

        boolean dbIsEmpty =
                ownerRepository.count() == 0 &&
                        apartmentRepository.count() == 0 &&
                        houseRepository.count() == 0 &&
                        duplexRepository.count() == 0 &&
                        townHouseRepository.count() == 0 &&
                        schoolRepository.count() == 0 &&
                        reviewerRepository.count() == 0 &&
                        reviewRepository.count() == 0;

        if (!dbIsEmpty) {
            System.out.println("Database already contains data. Populate skipped.");
            return;
        }

        System.out.println("Database is empty. Running populate...");

        int owners = 10;
        int properties = 50;
        int reviews = 100;
        int schools = 20;

        int result = populateDB.populateAll(owners, properties, reviews, schools);

        if (result > 0) {
            System.out.println("Populate completed. Properties created: " + result);
        } else {
            System.out.println("Populate failed.");
        }
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/repository/PropertyContractRepository.java
----------------------------------------
package com.example.apartment_predictor.repository;

import com.example.apartment_predictor.model.PropertyContract;
import org.springframework.data.repository.CrudRepository;

public interface PropertyContractRepository extends CrudRepository<PropertyContract, String> {
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/repository/TownHouseRepository.java
----------------------------------------
package com.example.apartment_predictor.repository;

import com.example.apartment_predictor.model.TownHouse;
import org.springframework.data.repository.CrudRepository;

public interface TownHouseRepository extends CrudRepository<TownHouse, String> {
}
----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/repository/ApartmentRepository.java
----------------------------------------
package com.example.apartment_predictor.repository;

import org.springframework.data.repository.CrudRepository;
import com.example.apartment_predictor.model.Apartment;

public interface ApartmentRepository extends CrudRepository<Apartment, String> {
}
----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/repository/DuplexRepository.java
----------------------------------------
package com.example.apartment_predictor.repository;

import org.springframework.data.repository.CrudRepository;
import com.example.apartment_predictor.model.Duplex;

public interface DuplexRepository extends CrudRepository <Duplex,String> {
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/repository/OwnerRepository.java
----------------------------------------
package com.example.apartment_predictor.repository;

import com.example.apartment_predictor.model.Owner;
import org.springframework.data.repository.CrudRepository;

public interface OwnerRepository extends CrudRepository<Owner, String> {
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/repository/ReviewRepository.java
----------------------------------------
package com.example.apartment_predictor.repository;

import com.example.apartment_predictor.model.Review;
import org.springframework.data.repository.CrudRepository;

public interface ReviewRepository extends CrudRepository<Review, String> {
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/repository/ReviewerRepository.java
----------------------------------------
package com.example.apartment_predictor.repository;

import com.example.apartment_predictor.model.Reviewer;
import org.springframework.data.repository.CrudRepository;

public interface ReviewerRepository extends CrudRepository<Reviewer, String> {
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/repository/HouseRepository.java
----------------------------------------
package com.example.apartment_predictor.repository;

import org.springframework.data.repository.CrudRepository;
import com.example.apartment_predictor.model.House;

public interface HouseRepository extends CrudRepository <House, String> {
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/repository/SchoolRepository.java
----------------------------------------
package com.example.apartment_predictor.repository;

import com.example.apartment_predictor.model.School;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

@Repository
public interface SchoolRepository extends JpaRepository<School, String> {
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/service/ReviewService.java
----------------------------------------
package com.example.apartment_predictor.service;

import com.example.apartment_predictor.model.Review;
import com.example.apartment_predictor.repository.ReviewRepository;
import org.springframework.stereotype.Service;

@Service
public class ReviewService {

    private final ReviewRepository reviewRepository;

    // ============================
    // CONSTRUCTOR
    // ============================
    public ReviewService(ReviewRepository reviewRepository) {
        this.reviewRepository = reviewRepository;
    }

    // ============================
    // CREATE
    // ============================
    public Review save(Review review) {
        return reviewRepository.save(review);
    }

    // ============================
    // DELETE
    // ============================
    public void delete(String id) {
        reviewRepository.deleteById(id);
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/service/DuplexService.java
----------------------------------------
package com.example.apartment_predictor.service;

import com.example.apartment_predictor.model.Duplex;
import com.example.apartment_predictor.repository.DuplexRepository;
import org.springframework.stereotype.Service;

import java.util.Optional;

@Service
public class DuplexService {

    private final DuplexRepository duplexRepository;

    // ============================
    // CONSTRUCTOR
    // ============================
    public DuplexService(DuplexRepository duplexRepository) {
        this.duplexRepository = duplexRepository;
    }

    // ============================
    // FIND ALL
    // ============================
    public Iterable<Duplex> findAll() {
        return duplexRepository.findAll();
    }

    // ============================
    // UPDATE DIRECTO
    // ============================
    public Duplex updateDuplex(Duplex duplex){
        return duplexRepository.save(duplex);
    }

    // ============================
    // UPDATE POR ID
    // ============================
    public Duplex updateDuplexById(String id, Duplex newDuplex) {
        Optional<Duplex> existingOpt = duplexRepository.findById(id);
        if (existingOpt.isEmpty()) return null;
        return duplexRepository.save(newDuplex);
    }

    // ============================
    // DELETE
    // ============================
    public void deleteDuplex(String id){
        duplexRepository.deleteById(id);
    }

    // ============================
    // FIND BY ID
    // ============================
    public Duplex findDuplexById(String id){
        return duplexRepository.findById(id).orElse(null);
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/service/TownHouseService.java
----------------------------------------
package com.example.apartment_predictor.service;

import com.example.apartment_predictor.model.TownHouse;
import com.example.apartment_predictor.repository.TownHouseRepository;
import org.springframework.stereotype.Service;

import java.util.Optional;

@Service
public class TownHouseService {

    private final TownHouseRepository townHouseRepository;

    // ============================
    // CONSTRUCTOR
    // ============================
    public TownHouseService(TownHouseRepository townHouseRepository) {
        this.townHouseRepository = townHouseRepository;
    }

    // ============================
    // FIND ALL
    // ============================
    public Iterable<TownHouse> findAll() {
        return townHouseRepository.findAll();
    }

    // ============================
    // UPDATE DIRECTO
    // ============================
    public TownHouse updateTownHouse(TownHouse townHouse){
        return townHouseRepository.save(townHouse);
    }

    // ============================
    // UPDATE POR ID
    // ============================
    public TownHouse updateTownHouseById(String id, TownHouse newTownHouse) {
        Optional<TownHouse> existingOpt = townHouseRepository.findById(id);
        if (existingOpt.isEmpty()) return null;
        return townHouseRepository.save(newTownHouse);
    }

    // ============================
    // DELETE
    // ============================
    public void deleteTownHouse(String id){
        townHouseRepository.deleteById(id);
    }

    // ============================
    // FIND BY ID
    // ============================
    public TownHouse findTownHouseById(String id){
        return townHouseRepository.findById(id).orElse(null);
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/service/ReviewerService.java
----------------------------------------
package com.example.apartment_predictor.service;

import com.example.apartment_predictor.model.Reviewer;
import com.example.apartment_predictor.repository.ReviewerRepository;
import org.springframework.stereotype.Service;

import java.util.Optional;

@Service
public class ReviewerService {

    private final ReviewerRepository reviewerRepository;

    // ============================
    // CONSTRUCTOR
    // ============================
    public ReviewerService(ReviewerRepository reviewerRepository) {
        this.reviewerRepository = reviewerRepository;
    }

    // ============================
    // FIND ALL
    // ============================
    public Iterable<Reviewer> findAll() {
        return reviewerRepository.findAll();
    }

    // ============================
    // UPDATE DIRECTO
    // ============================
    public Reviewer updateReviewer(Reviewer reviewer){
        return reviewerRepository.save(reviewer);
    }

    // ============================
    // UPDATE POR ID
    // ============================
    public Reviewer updateReviewerById(String id, Reviewer newReviewer) {
        Optional<Reviewer> existingOpt = reviewerRepository.findById(id);
        if (existingOpt.isEmpty()) return null;
        return reviewerRepository.save(newReviewer);
    }

    // ============================
    // DELETE
    // ============================
    public void deleteReviewer(String id){
        reviewerRepository.deleteById(id);
    }

    // ============================
    // FIND BY ID
    // ============================
    public Reviewer findReviewerById(String id){
        return reviewerRepository.findById(id).orElse(null);
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/service/PropertyService.java
----------------------------------------
package com.example.apartment_predictor.service;

import com.example.apartment_predictor.model.Property;
import com.example.apartment_predictor.repository.ApartmentRepository;
import com.example.apartment_predictor.repository.DuplexRepository;
import com.example.apartment_predictor.repository.HouseRepository;
import com.example.apartment_predictor.repository.TownHouseRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

@Service
public class PropertyService {

    @Autowired
    private ApartmentRepository apartmentRepo;
    @Autowired private HouseRepository houseRepo;
    @Autowired private DuplexRepository duplexRepo;
    @Autowired private TownHouseRepository townRepo;

    public Property findById(String id) {
        return apartmentRepo.findById(id)
                .map(p -> (Property)p)
                .or(() -> houseRepo.findById(id).map(p -> (Property)p))
                .or(() -> duplexRepo.findById(id).map(p -> (Property)p))
                .or(() -> townRepo.findById(id).map(p -> (Property)p))
                .orElse(null);
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/service/PropertyContractService.java
----------------------------------------
package com.example.apartment_predictor.service;

import com.example.apartment_predictor.model.Owner;
import com.example.apartment_predictor.model.Property;
import com.example.apartment_predictor.model.PropertyContract;
import com.example.apartment_predictor.repository.PropertyContractRepository;
import org.springframework.stereotype.Service;

import java.time.LocalDate;
import java.util.Optional;

@Service
public class PropertyContractService {

    private final PropertyContractRepository contractRepository;

    // ============================
    // CONSTRUCTOR
    // ============================
    public PropertyContractService(PropertyContractRepository contractRepository) {
        this.contractRepository = contractRepository;
    }

    // ============================
    // FIND ALL
    // ============================
    public Iterable<PropertyContract> findAll() {
        return contractRepository.findAll();
    }

    // ============================
    // FIND BY ID
    // ============================
    public Optional<PropertyContract> findById(String id) {
        return contractRepository.findById(id);
    }

    // ============================
    // CREATE
    // ============================
    public PropertyContract createContract(Owner owner, Property property, double agreedPrice) {

        PropertyContract contract = new PropertyContract();
        contract.setOwner(owner);
        contract.setProperty(property);
        contract.setAgreedPrice(agreedPrice);
        contract.setStartDate(LocalDate.now());
        contract.setActive(true);

        return contractRepository.save(contract);
    }

    // ============================
    // CLOSE CONTRACT
    // ============================
    public PropertyContract closeContract(String id) {
        Optional<PropertyContract> opt = contractRepository.findById(id);
        if (opt.isEmpty()) return null;

        PropertyContract contract = opt.get();
        contract.setActive(false);
        contract.setEndDate(LocalDate.now());

        return contractRepository.save(contract);
    }

    // ============================
    // DELETE
    // ============================
    public void deleteContract(String id) {
        contractRepository.deleteById(id);
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/service/HouseService.java
----------------------------------------
package com.example.apartment_predictor.service;

import com.example.apartment_predictor.model.House;
import com.example.apartment_predictor.repository.HouseRepository;
import org.springframework.stereotype.Service;

import java.util.Optional;

@Service
public class HouseService {

    private final HouseRepository houseRepository;

    // ============================
    // CONSTRUCTOR
    // ============================
    public HouseService(HouseRepository houseRepository) {
        this.houseRepository = houseRepository;
    }

    // ============================
    // FIND ALL
    // ============================
    public Iterable<House> findAll() {
        return houseRepository.findAll();
    }

    // ============================
    // UPDATE DIRECTO
    // ============================
    public House updateHouse(House house){
        return houseRepository.save(house);
    }

    // ============================
    // UPDATE POR ID
    // ============================
    public House updateHouseById(String id, House newHouse) {
        return houseRepository.findById(id).map(existing -> {

            existing.setName(newHouse.getName());
            existing.setAddress(newHouse.getAddress());
            existing.setOwner(newHouse.getOwner());
            existing.setNearbySchools(newHouse.getNearbySchools());

            return houseRepository.save(existing);

        }).orElse(null);
    }


    // ============================
    // DELETE
    // ============================
    public void deleteHouse(String id){
        houseRepository.deleteById(id);
    }

    // ============================
    // FIND BY ID
    // ============================
    public House findHouseById(String id){
        return houseRepository.findById(id).orElse(null);
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/service/OwnerService.java
----------------------------------------
package com.example.apartment_predictor.service;

import com.example.apartment_predictor.model.Owner;
import com.example.apartment_predictor.repository.OwnerRepository;
import org.springframework.stereotype.Service;

import java.util.Optional;

@Service
public class OwnerService {

    private final OwnerRepository ownerRepository;

    // ============================
    // CONSTRUCTOR
    // ============================
    public OwnerService(OwnerRepository ownerRepository) {
        this.ownerRepository = ownerRepository;
    }

    // ============================
    // FIND ALL
    // ============================
    public Iterable<Owner> findAll() {
        return ownerRepository.findAll();
    }

    // ============================
    // UPDATE DIRECTO
    // ============================
    public Owner updateOwner(Owner owner){
        return ownerRepository.save(owner);
    }

    // ============================
    // UPDATE POR ID
    // ============================
    public Owner updateOwnerById(String id, Owner newOwner) {
        Optional<Owner> existingOpt = ownerRepository.findById(id);
        if (existingOpt.isEmpty()) return null;
        return ownerRepository.save(newOwner);
    }

    // ============================
    // DELETE
    // ============================
    public void deleteOwner(String id){
        ownerRepository.deleteById(id);
    }

    // ============================
    // FIND BY ID
    // ============================
    public Owner findOwnerById(String id){
        return ownerRepository.findById(id).orElse(null);
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/service/ApartmentService.java
----------------------------------------
package com.example.apartment_predictor.service;

import com.example.apartment_predictor.model.Apartment;
import com.example.apartment_predictor.repository.ApartmentRepository;
import org.springframework.stereotype.Service;

import java.util.Optional;

@Service
public class ApartmentService {

    private final ApartmentRepository apartmentRepository;

    // ============================
    // CONSTRUCTOR
    // ============================
    public ApartmentService(ApartmentRepository apartmentRepository) {
        this.apartmentRepository = apartmentRepository;
    }

    // ============================
    // FIND ALL
    // ============================
    public Iterable<Apartment> findAll() {
        return apartmentRepository.findAll();
    }

    // ============================
    // CREATE
    // ============================
    public Apartment createApartment(Apartment apartment){
        return apartmentRepository.save(apartment);
    }

    // ============================
    // UPDATE DIRECTO
    // ============================
    public Apartment updateApartment(Apartment apartment){
        return apartmentRepository.save(apartment);
    }

    // ============================
    // UPDATE POR ID
    // ============================
    public Apartment updateApartmentById(String id, Apartment newApartment) {

        Optional<Apartment> existingOpt = apartmentRepository.findById(id);
        if (existingOpt.isEmpty()) return null;

        Apartment existing = existingOpt.get();

        existing.setPrice(newApartment.getPrice());
        existing.setArea(newApartment.getArea());
        existing.setBedrooms(newApartment.getBedrooms());
        existing.setBathrooms(newApartment.getBathrooms());
        existing.setStories(newApartment.getStories());
        existing.setMainroad(newApartment.getMainroad());
        existing.setGuestroom(newApartment.getGuestroom());
        existing.setBasement(newApartment.getBasement());
        existing.setHotwaterheating(newApartment.getHotwaterheating());
        existing.setAirconditioning(newApartment.getAirconditioning());
        existing.setParking(newApartment.getParking());
        existing.setPrefarea(newApartment.getPrefarea());
        existing.setFurnishingstatus(newApartment.getFurnishingstatus());

        existing.getNearbySchools().clear();
        if (newApartment.getNearbySchools() != null) {
            existing.getNearbySchools().addAll(newApartment.getNearbySchools());
        }

        return apartmentRepository.save(existing);
    }

    // ============================
    // DELETE
    // ============================
    public void deleteApartment(String id){
        apartmentRepository.deleteById(id);
    }

    // ============================
    // FIND BY ID
    // ============================
    public Apartment findApartmentById(String id){
        return apartmentRepository.findById(id).orElse(null);
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/model/Apartment.java
----------------------------------------
package com.example.apartment_predictor.model;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;

import java.util.UUID;

@Entity
@DiscriminatorValue("APARTMENT")
public class Apartment extends Property {

    // ============================
    // CAMPOS
    // ============================
    private String name;
    private Integer price;
    private Integer area;
    private Integer bedrooms;
    private Integer bathrooms;
    private Integer stories;

    private String mainroad;
    private String guestroom;
    private String basement;
    private String hotwaterheating;
    private String airconditioning;

    private Integer parking;
    private String prefarea;
    private String furnishingstatus;

    // ============================
    // CONSTRUCTORES
    // ============================
    public Apartment() {
        this.id = UUID.randomUUID().toString();
    }

    public Apartment(Integer price, Integer area, Integer bedrooms, Integer bathrooms, Integer stories,
                     String mainroad, String guestroom, String basement, String hotwaterheating,
                     String airconditioning, Integer parking, String prefarea, String furnishingstatus) {
        this.id = UUID.randomUUID().toString();
        this.name = name;
        this.price = price;
        this.area = area;
        this.bedrooms = bedrooms;
        this.bathrooms = bathrooms;
        this.stories = stories;
        this.mainroad = mainroad;
        this.guestroom = guestroom;
        this.basement = basement;
        this.hotwaterheating = hotwaterheating;
        this.airconditioning = airconditioning;
        this.parking = parking;
        this.prefarea = prefarea;
        this.furnishingstatus = furnishingstatus;
    }

    // ============================
    // GETTERS
    // ============================
    public void setName(String name) {this.name = name;}
    public String getName() {return name;}
    public Integer getPrice() {return price;}
    public Integer getArea() {return area;}
    public Integer getBedrooms() {return bedrooms;}
    public Integer getBathrooms() {return bathrooms;}
    public Integer getStories() {return stories;}
    public String getMainroad() {return mainroad;}
    public String getGuestroom() {return guestroom;}
    public String getBasement() {return basement;}
    public String getHotwaterheating() {return hotwaterheating;}
    public String getAirconditioning() {return airconditioning;}
    public Integer getParking() {return parking;}
    public String getPrefarea() {return prefarea;}
    public String getFurnishingstatus() {return furnishingstatus;}

    // ============================
    // SETTERS
    // ============================
    public void setPrice(Integer price) {this.price = price;}
    public void setArea(Integer area) {this.area = area;}
    public void setBedrooms(Integer bedrooms) {this.bedrooms = bedrooms;}
    public void setBathrooms(Integer bathrooms) {this.bathrooms = bathrooms;}
    public void setStories(Integer stories) {this.stories = stories;}
    public void setMainroad(String mainroad) {this.mainroad = mainroad;}
    public void setGuestroom(String guestroom) {this.guestroom = guestroom;}
    public void setBasement(String basement) {this.basement = basement;}
    public void setHotwaterheating(String hotwaterheating) {this.hotwaterheating = hotwaterheating;}
    public void setAirconditioning(String airconditioning) {this.airconditioning = airconditioning;}
    public void setParking(Integer parking) {this.parking = parking;}
    public void setPrefarea(String prefarea) {this.prefarea = prefarea;}
    public void setFurnishingstatus(String furnishingstatus) {this.furnishingstatus = furnishingstatus;}

    // ============================
    // TO STRING
    // ============================
    @Override
    public String toString() {
        return "Apartment{" +
                "id='" + id + '\'' +
                ", address='" + address + '\'' +
                ", name=" + name +
                ", price=" + price +
                ", area=" + area +
                ", bedrooms=" + bedrooms +
                ", bathrooms=" + bathrooms +
                ", stories=" + stories +
                '}';
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/model/Reviewer.java
----------------------------------------
package com.example.apartment_predictor.model;

import jakarta.persistence.Entity;
import jakarta.persistence.OneToMany;

import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;

@Entity
public class Reviewer extends Person {

    // ============================
    // CAMPOS
    // ============================
    private int reputation;
    private boolean isBusiness;
    private String xAccount;
    private String webURL;
    private int qtyReviews;

    // ============================
    // RELACIONES
    // ============================
    @OneToMany(mappedBy = "reviewer")
    private List<Review> reviews = new ArrayList<>();

    // ============================
    // CONSTRUCTORES
    // ============================
    public Reviewer() {
        super();
    }

    public Reviewer(String fullName, String email, int reputation) {
        super(fullName, null, null, email, null, true);
        this.reputation = reputation;
    }

    public Reviewer(String fullName, LocalDate birthDate, String phone, String email,
                    String password, boolean isActive, int reputation,
                    boolean isBusiness, String xAccount, String webURL, int qtyReviews) {
        super(fullName, birthDate, phone, email, password, isActive);
        this.reputation = reputation;
        this.isBusiness = isBusiness;
        this.xAccount = xAccount;
        this.webURL = webURL;
        this.qtyReviews = qtyReviews;
    }

    // ============================
    // GETTERS
    // ============================
    public int getReputation() {return reputation;}
    public boolean isBusiness() {return isBusiness;}
    public String getxAccount() {return xAccount;}
    public String getWebURL() {return webURL;}
    public int getQtyReviews() {return qtyReviews;}
    public List<Review> getReviews() {return reviews;}

    // ============================
    // SETTERS
    // ============================
    public void setReputation(int reputation) {this.reputation = reputation;}
    public void setBusiness(boolean business) {isBusiness = business;}
    public void setxAccount(String xAccount) {this.xAccount = xAccount;}
    public void setWebURL(String webURL) {this.webURL = webURL;}
    public void setQtyReviews(int qtyReviews) {this.qtyReviews = qtyReviews;}
    public void setReviews(List<Review> reviews) {this.reviews = reviews;}

    // ============================
    // TO STRING
    // ============================
    @Override
    public String toString() {
        return "Reviewer{" +
                "id='" + getId() + '\'' +
                ", fullName='" + getFullName() + '\'' +
                ", reputation=" + reputation +
                ", isBusiness=" + isBusiness +
                ", xAccount='" + xAccount + '\'' +
                ", webURL='" + webURL + '\'' +
                ", qtyReviews=" + qtyReviews +
                '}';
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/model/Review.java
----------------------------------------
package com.example.apartment_predictor.model;

import com.fasterxml.jackson.annotation.JsonBackReference;
import jakarta.persistence.*;

import java.time.LocalDate;

@Entity
public class Review {

    // ============================
    // ID
    // ============================
    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private String id;

    // ============================
    // CAMPOS
    // ============================
    private String title;

    @Lob
    private String content;

    private int rating;
    private LocalDate reviewDate;

    // ============================
    // RELACIONES
    // ============================
    @ManyToOne
    @JoinColumn(name = "property_id")
    @JsonBackReference
    private Property property;


    @ManyToOne
    @JoinColumn(name = "reviewer_id")
    private Reviewer reviewer;

    // ============================
    // CONSTRUCTORES
    // ============================
    public Review() {
    }

    public Review(String title, String content, int rating,
                  LocalDate reviewDate, Property property, Reviewer reviewer) {
        this.title = title;
        this.content = content;
        this.rating = rating;
        this.reviewDate = reviewDate;
        this.property = property;
        this.reviewer = reviewer;
    }

    // ============================
    // GETTERS
    // ============================
    public String getId() {return id;}
    public String getTitle() {return title;}
    public String getContent() {return content;}
    public int getRating() {return rating;}
    public LocalDate getReviewDate() {return reviewDate;}
    public Property getProperty() {return property;}
    public Reviewer getReviewer() {return reviewer;}

    // ============================
    // SETTERS
    // ============================
    public void setTitle(String title) {this.title = title;}
    public void setContent(String content) {this.content = content;}
    public void setRating(int rating) {this.rating = rating;}
    public void setReviewDate(LocalDate reviewDate) {this.reviewDate = reviewDate;}
    public void setProperty(Property property) {this.property = property;}
    public void setReviewer(Reviewer reviewer) {this.reviewer = reviewer;}

    // ============================
    // TO STRING
    // ============================
    @Override
    public String toString() {
        return "Review{" +
                "id='" + id + '\'' +
                ", title='" + title + '\'' +
                ", rating=" + rating +
                ", reviewDate=" + reviewDate +
                ", propertyId=" + (property != null ? property.getId() : "null") +
                ", reviewerId=" + (reviewer != null ? reviewer.getId() : "null") +
                '}';
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/model/TownHouse.java
----------------------------------------
package com.example.apartment_predictor.model;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;
import java.util.List;
import java.util.UUID;

@Entity
@DiscriminatorValue("TOWNHOUSE")
public class TownHouse extends Property {

    private String name;
    // Usa el address heredado de Property

    // ============================
    // RELACIONES
    // ============================
    // PropertyContract YA VIENE DE Property

    // ============================
    // CONSTRUCTORES
    // ============================
    public TownHouse() {
        this.id = UUID.randomUUID().toString();
    }

    public TownHouse(String id, String name, String address, Owner owner, List<School> nearbySchools) {
        this.id = id;
        this.name = name;
        this.address = address;
        this.owner = owner;
        this.nearbySchools = nearbySchools;
    }

    // ============================
    // GETTERS
    // ============================
    public String getName() { return name; }

    // ============================
    // SETTERS
    // ============================
    public void setName(String name) { this.name = name; }

    // ============================
    // TO STRING
    // ============================
    @Override
    public String toString() {
        return "TownHouse{" +
                "name='" + name + '\'' +
                ", address='" + address + '\'' +
                ", id='" + id + '\'' +
                '}';
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/model/PropertyContract.java
----------------------------------------
package com.example.apartment_predictor.model;

import jakarta.persistence.*;

import java.time.LocalDate;
import java.util.UUID;

@Entity
public class PropertyContract {

    // ============================
    // ID
    // ============================
    @Id
    private String id;

    // ============================
    // CAMPOS
    // ============================
    private String contractName;
    private String contractDetails;
    private double agreedPrice;
    private LocalDate startDate;
    private LocalDate endDate;
    private boolean active;

    // ============================
    // RELACIONES
    // ============================
    @ManyToOne
    @JoinColumn(name = "owner_id")
    private Owner owner;

    @ManyToOne
    @JoinColumn(name = "property_id")
    private Property property;

    // ============================
    // CONSTRUCTORES
    // ============================
    public PropertyContract() {
        this.id = UUID.randomUUID().toString();
    }

    public PropertyContract(String contractName, String contractDetails,
                            double agreedPrice, LocalDate startDate,
                            Owner owner, Property property) {
        this.id = UUID.randomUUID().toString();
        this.contractName = contractName;
        this.contractDetails = contractDetails;
        this.agreedPrice = agreedPrice;
        this.startDate = startDate;
        this.active = true;
        this.owner = owner;
        this.property = property;
    }

    // ============================
    // GETTERS
    // ============================
    public String getId() {return id;}
    public String getContractName() {return contractName;}
    public String getContractDetails() {return contractDetails;}
    public double getAgreedPrice() {return agreedPrice;}
    public LocalDate getStartDate() {return startDate;}
    public LocalDate getEndDate() {return endDate;}
    public boolean isActive() {return active;}
    public Owner getOwner() {return owner;}
    public Property getProperty() {return property;}

    // ============================
    // SETTERS
    // ============================
    public void setContractName(String contractName) {this.contractName = contractName;}
    public void setContractDetails(String contractDetails) {this.contractDetails = contractDetails;}
    public void setAgreedPrice(double agreedPrice) {this.agreedPrice = agreedPrice;}
    public void setStartDate(LocalDate startDate) {this.startDate = startDate;}
    public void setEndDate(LocalDate endDate) {this.endDate = endDate;}
    public void setActive(boolean active) {this.active = active;}
    public void setOwner(Owner owner) {this.owner = owner;}
    public void setProperty(Property property) {this.property = property;}

    // ============================
    // TO STRING
    // ============================
    @Override
    public String toString() {
        return "PropertyContract{" +
                "id='" + id + '\'' +
                ", contractName='" + contractName + '\'' +
                ", agreedPrice=" + agreedPrice +
                ", active=" + active +
                ", ownerId=" + (owner != null ? owner.getId() : "null") +
                ", propertyId=" + (property != null ? property.getId() : "null") +
                '}';
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/model/Owner.java
----------------------------------------
package com.example.apartment_predictor.model;

import jakarta.persistence.*;

import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;

@Entity
public class Owner extends Person {

    // ============================
    // CAMPOS
    // ============================
    private boolean isBusiness;
    private String idLegalOwner;
    private LocalDate registrationDate;
    private int qtyDaysAsOwner;

    // ============================
    // RELACIONES
    // ============================
    @OneToMany(mappedBy = "owner", cascade = CascadeType.ALL)
    private List<PropertyContract> contracts = new ArrayList<>();

    @OneToMany(mappedBy = "owner", cascade = CascadeType.ALL)
    private List<House> houses = new ArrayList<>();

    @OneToMany(mappedBy = "owner", cascade = CascadeType.ALL)
    private List<Duplex> duplexes = new ArrayList<>();

    @OneToMany(mappedBy = "owner", cascade = CascadeType.ALL)
    private List<TownHouse> townHouses = new ArrayList<>();

    // ============================
    // CONSTRUCTORES
    // ============================
    public Owner() {
        super();
    }

    public Owner(String fullName, String email, String phone) {
        super(fullName, null, phone, email, null, true);
        this.registrationDate = LocalDate.now();
    }

    public Owner(String fullName, LocalDate birthDate, String phone, String email,
                 String password, boolean isActive, boolean isBusiness,
                 String idLegalOwner, LocalDate registrationDate, int qtyDaysAsOwner) {
        super(fullName, birthDate, phone, email, password, isActive);
        this.isBusiness = isBusiness;
        this.idLegalOwner = idLegalOwner;
        this.registrationDate = registrationDate;
        this.qtyDaysAsOwner = qtyDaysAsOwner;
    }

    // ============================
    // GETTERS
    // ============================
    public boolean isBusiness() {return isBusiness;}
    public String getIdLegalOwner() {return idLegalOwner;}
    public LocalDate getRegistrationDate() {return registrationDate;}
    public int getQtyDaysAsOwner() {return qtyDaysAsOwner;}
    public List<PropertyContract> getContracts() {return contracts;}
    public List<House> getHouses() {return houses;}
    public List<Duplex> getDuplexes() {return duplexes;}
    public List<TownHouse> getTownHouses() {return townHouses;}

    // ============================
    // SETTERS
    // ============================
    public void setBusiness(boolean business) {isBusiness = business;}
    public void setIdLegalOwner(String idLegalOwner) {this.idLegalOwner = idLegalOwner;}
    public void setRegistrationDate(LocalDate registrationDate) {this.registrationDate = registrationDate;}
    public void setQtyDaysAsOwner(int qtyDaysAsOwner) {this.qtyDaysAsOwner = qtyDaysAsOwner;}
    public void setContracts(List<PropertyContract> contracts) {this.contracts = contracts;}
    public void setHouses(List<House> houses) {this.houses = houses;}
    public void setDuplexes(List<Duplex> duplexes) {this.duplexes = duplexes;}
    public void setTownHouses(List<TownHouse> townHouses) {this.townHouses = townHouses;}

    // ============================
    // TO STRING
    // ============================
    @Override
    public String toString() {
        return "Owner{" +
                "id='" + getId() + '\'' +
                ", fullName='" + getFullName() + '\'' +
                ", isBusiness=" + isBusiness +
                ", idLegalOwner='" + idLegalOwner + '\'' +
                ", registrationDate=" + registrationDate +
                ", qtyDaysAsOwner=" + qtyDaysAsOwner +
                '}';
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/model/Duplex.java
----------------------------------------
package com.example.apartment_predictor.model;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;
import java.util.List;
import java.util.UUID;

@Entity
@DiscriminatorValue("DUPLEX")
public class Duplex extends Property {

    private String name;
    // Usa el address heredado de Property

    // ============================
    // RELACIONES
    // ============================
    // PropertyContract YA VIENE DE Property

    // ============================
    // CONSTRUCTORES
    // ============================
    public Duplex() {
        this.id = UUID.randomUUID().toString();
    }

    public Duplex(String id, String name, String address, Owner owner, List<School> nearbySchools) {
        this.id = id;
        this.name = name;
        this.address = address;
        this.owner = owner;
        this.nearbySchools = nearbySchools;
    }

    // ============================
    // GETTERS
    // ============================
    public String getName() { return name; }

    // ============================
    // SETTERS
    // ============================
    public void setName(String name) { this.name = name; }

    // ============================
    // TO STRING
    // ============================
    @Override
    public String toString() {
        return "Duplex{" +
                "name='" + name + '\'' +
                ", address='" + address + '\'' +
                ", id='" + id + '\'' +
                '}';
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/model/Person.java
----------------------------------------
package com.example.apartment_predictor.model;

import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import jakarta.persistence.MappedSuperclass;

import java.time.LocalDate;

@MappedSuperclass
public abstract class Person {

    // ============================
    // ID
    // ============================
    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private String id;

    // ============================
    // CAMPOS
    // ============================
    private String fullName;
    private LocalDate birthDate;
    private String phone;
    private String email;
    private String password;
    private boolean isActive;

    // ============================
    // CONSTRUCTORES
    // ============================
    public Person() {
    }

    public Person(String fullName, LocalDate birthDate, String phone,
                  String email, String password, boolean isActive) {
        this.fullName = fullName;
        this.birthDate = birthDate;
        this.phone = phone;
        this.email = email;
        this.password = password;
        this.isActive = isActive;
    }

    // ============================
    // GETTERS
    // ============================
    public String getId() {return id;}
    public String getFullName() {return fullName; }
    public LocalDate getBirthDate() { return birthDate;}
    public String getPhone() {return phone;}
    public String getEmail() {return email;}
    public String getPassword() {return password;}
    public boolean isActive() {return isActive;}

    // ============================
    // SETTERS
    // ============================
    public void setFullName(String fullName) {this.fullName = fullName;}
    public void setBirthDate(LocalDate birthDate) {this.birthDate = birthDate;}
    public void setPhone(String phone) {this.phone = phone;}
    public void setEmail(String email) {this.email = email;}
    public void setPassword(String password) {this.password = password;}
    public void setActive(boolean active) {isActive = active;}
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/model/School.java
----------------------------------------
package com.example.apartment_predictor.model;

import jakarta.persistence.*;

import java.util.ArrayList;
import java.util.List;
import java.util.UUID;

@Entity
public class School {

    // ============================
    // ID
    // ============================
    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private String id;

    // ============================
    // CAMPOS
    // ============================
    private String name;
    private String address;
    private String type;
    private String educationLevel;
    private String location;
    private int rating;
    private boolean isPublic;

    // ============================
    // RELACIONES
    // ============================
    @ManyToMany(mappedBy = "nearbySchools")
    private List<Property> properties = new ArrayList<>();

    // ============================
    // CONSTRUCTORES
    // ============================
    public School() {
    }

    public School(String name, String address, String type,
                  String educationLevel, String location,
                  int rating, boolean isPublic) {
        this.name = name;
        this.address = address;
        this.type = type;
        this.educationLevel = educationLevel;
        this.location = location;
        this.rating = rating;
        this.isPublic = isPublic;
    }

    // ============================
    // GETTERS
    // ============================
    public String getId() {return id;}
    public String getName() {return name;}
    public String getAddress() {return address;}
    public String getType() {return type;}
    public String getEducationLevel() {return educationLevel;}
    public String getLocation() {return location;}
    public int getRating() {return rating;}
    public boolean isPublic() {return isPublic;}
    public List<Property> getProperties() {return properties;}

    // ============================
    // SETTERS
    // ============================
    public void setName(String name) {this.name = name;}
    public void setAddress(String address) {this.address = address;}
    public void setType(String type) {this.type = type;}
    public void setEducationLevel(String educationLevel) {this.educationLevel = educationLevel;}
    public void setLocation(String location) {this.location = location;}
    public void setRating(int rating) {this.rating = rating;}
    public void setPublic(boolean aPublic) {isPublic = aPublic;}
    public void setProperties(List<Property> properties) {this.properties = properties;}

    // ============================
    // TO STRING
    // ============================
    @Override
    public String toString() {
        return "School{" +
                "id='" + id + '\'' +
                ", name='" + name + '\'' +
                ", address='" + address + '\'' +
                ", type='" + type + '\'' +
                ", educationLevel='" + educationLevel + '\'' +
                ", location='" + location + '\'' +
                ", rating=" + rating +
                ", isPublic=" + isPublic +
                '}';
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/model/Property.java
----------------------------------------
package com.example.apartment_predictor.model;

import com.fasterxml.jackson.annotation.JsonManagedReference;
import jakarta.persistence.*;

import java.util.ArrayList;
import java.util.List;

@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "property_type")
public abstract class Property {

    // ============================
    // ID
    // ============================
    @Id
    protected String id;

    // ============================
    // CAMPOS
    // ============================
    protected String address;

    // ============================
    // RELACIONES
    // ============================
    @ManyToOne
    @JoinColumn(name = "owner_id")
    protected Owner owner;

    @ManyToMany
    @JoinTable(
            name = "property_school",
            joinColumns = @JoinColumn(name = "property_id"),
            inverseJoinColumns = @JoinColumn(name = "school_id")
    )
    protected List<School> nearbySchools = new ArrayList<>();

    @OneToMany(mappedBy = "property", cascade = CascadeType.ALL)
    protected List<PropertyContract> propertyContracts = new ArrayList<>();

    @OneToMany(mappedBy = "property", cascade = CascadeType.ALL)
    @JsonManagedReference
    private List<Review> reviews = new ArrayList<>();


    // ============================
    // CONSTRUCTORES
    // ============================
    public Property() {}

    // ============================
    // GETTERS
    // ============================
    public String getId() {return id;}
    public String getAddress() {return address;}
    public Owner getOwner() {return owner;}
    public List<School> getNearbySchools() {return nearbySchools;}
    public List<PropertyContract> getPropertyContracts() {return propertyContracts;}
    public List<Review> getReviews() {return reviews;}

    // ============================
    // SETTERS
    // ============================
    public void setAddress(String address) {this.address = address;}
    public void setOwner(Owner owner) {this.owner = owner;}
    public void setNearbySchools(List<School> nearbySchools) {this.nearbySchools = nearbySchools;}
    public void setPropertyContracts(List<PropertyContract> propertyContracts) {this.propertyContracts = propertyContracts;}
    public void setReviews(List<Review> reviews) {this.reviews = reviews;}

}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/model/House.java
----------------------------------------
package com.example.apartment_predictor.model;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;

import java.util.UUID;

@Entity
@DiscriminatorValue("HOUSE")
public class House extends Property {

    // ============================
    // CAMPOS
    // ============================
    private String name;
    // Usa el address heredado de Property


    // ============================
    // CONSTRUCTORES
    // ============================
    public House() {
        this.id = UUID.randomUUID().toString();
    }

    public House(String name, String address, Owner owner) {
        this.id = UUID.randomUUID().toString();
        this.name = name;
        this.address = address;
        this.owner = owner;
    }

    // ============================
    // GETTERS
    // ============================
    public String getName() {return name;}

    // ============================
    // SETTERS
    // ============================
    public void setName(String name) {this.name = name;}

    // ============================
    // TO STRING
    // ============================
    @Override
    public String toString() {
        return "House{" +
                "id='" + id + '\'' +
                ", name='" + name + '\'' +
                ", addressLocal='" + address + '\'' +
                '}';
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/utils/PopulateDB.java
----------------------------------------
package com.example.apartment_predictor.utils;

import com.example.apartment_predictor.model.*;
import com.example.apartment_predictor.repository.*;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.ThreadLocalRandom;

@Component
public class PopulateDB {

    // ============================
    // REPOSITORIES
    // ============================
    @Autowired private ApartmentRepository apartmentRepository;
    @Autowired private HouseRepository houseRepository;
    @Autowired private DuplexRepository duplexRepository;
    @Autowired private TownHouseRepository townHouseRepository;

    @Autowired private SchoolRepository schoolRepository;
    @Autowired private ReviewerRepository reviewerRepository;
    @Autowired private ReviewRepository reviewRepository;
    @Autowired private OwnerRepository ownerRepository;
    @Autowired private PropertyContractRepository propertyContractRepository;

    // ============================
    // ORCHESTRATOR
    // ============================
    public int populateAll(int ownersQty, int propertiesQty, int reviewsQty, int schoolsQty) {

        List<Owner> owners = populateOwners(ownersQty);
        List<Property> properties = populateProperties(propertiesQty, owners);
        List<School> schools = populateSchools(schoolsQty);
        assignSchoolsToProperties(properties, schools);

        List<Reviewer> reviewers = populateReviewers(ownersQty);
        List<Review> reviews = populateReviews(reviewsQty, reviewers, properties);

        List<PropertyContract> contracts = populateContracts(propertiesQty, owners, properties);

        return properties.size();
    }

    // ============================
    // OWNERS
    // ============================
    private List<Owner> populateOwners(int qty) {

        List<Owner> owners = new ArrayList<>();
        ThreadLocalRandom rnd = ThreadLocalRandom.current();

        String[] firstNames = {"Carlos", "LucÃ­a", "Miguel", "Ana", "Javier", "Marta", "Pablo", "Laura"};
        String[] lastNames = {"GarcÃ­a", "LÃ³pez", "MartÃ­nez", "SÃ¡nchez", "FernÃ¡ndez", "GÃ³mez", "DÃ­az", "Ruiz"};
        String[] phones = {"+34 600111222", "+34 600333444", "+34 600555666", "+34 600777888", "+34 600999000"};
        String[] domains = {"gmail.com", "yahoo.com", "hotmail.com", "outlook.com", "example.com"};

        for (int i = 0; i < qty; i++) {

            String fullName = firstNames[rnd.nextInt(firstNames.length)] + " " +
                    lastNames[rnd.nextInt(lastNames.length)];

            String email = fullName.toLowerCase().replace(" ", ".") + "@" +
                    domains[rnd.nextInt(domains.length)];

            Owner owner = new Owner(
                    fullName,
                    LocalDate.now().minusYears(rnd.nextInt(25, 70)),
                    phones[rnd.nextInt(phones.length)],
                    email,
                    "password123",
                    true,
                    rnd.nextBoolean(),
                    "ID-" + rnd.nextInt(100000, 999999),
                    LocalDate.now().minusDays(rnd.nextInt(0, 365)),
                    rnd.nextInt(0, 3650)
            );

            ownerRepository.save(owner);
            owners.add(owner);
        }

        return owners;
    }

    // ============================
    // PROPERTIES
    // ============================
    private List<Property> populateProperties(int qty, List<Owner> owners) {

        List<Property> properties = new ArrayList<>();
        ThreadLocalRandom rnd = ThreadLocalRandom.current();

        int apartmentsQty = (int) (qty * 0.40);
        int housesQty = (int) (qty * 0.20);
        int duplexQty = (int) (qty * 0.20);
        int townQty = qty - apartmentsQty - housesQty - duplexQty;

        for (int i = 0; i < apartmentsQty; i++) {
            properties.add(createApartment(owners));
        }
        for (int i = 0; i < housesQty; i++) {
            properties.add(createHouse(owners));
        }
        for (int i = 0; i < duplexQty; i++) {
            properties.add(createDuplex(owners));
        }
        for (int i = 0; i < townQty; i++) {
            properties.add(createTownHouse(owners));
        }

        return properties;
    }

    private Apartment createApartment(List<Owner> owners) {

        ThreadLocalRandom rnd = ThreadLocalRandom.current();

        Apartment a = new Apartment();
        a.setPrice(rnd.nextInt(30000, 600000));
        a.setArea(rnd.nextInt(300, 5000));
        a.setBedrooms(rnd.nextInt(1, 6));
        a.setBathrooms(rnd.nextInt(1, 4));
        a.setStories(rnd.nextInt(1, 5));
        a.setMainroad(rnd.nextBoolean() ? "yes" : "no");
        a.setGuestroom(rnd.nextBoolean() ? "yes" : "no");
        a.setBasement(rnd.nextBoolean() ? "yes" : "no");
        a.setHotwaterheating(rnd.nextBoolean() ? "yes" : "no");
        a.setAirconditioning(rnd.nextBoolean() ? "yes" : "no");
        a.setParking(rnd.nextInt(0, 3));
        a.setPrefarea(rnd.nextBoolean() ? "yes" : "no");
        a.setFurnishingstatus("furnished");

        a.setName("Apartment " + rnd.nextInt(1000));
        a.setAddress("Street " + rnd.nextInt(1, 200));
        a.setOwner(owners.get(rnd.nextInt(owners.size())));

        apartmentRepository.save(a);
        return a;
    }

    private House createHouse(List<Owner> owners) {

        ThreadLocalRandom rnd = ThreadLocalRandom.current();

        House h = new House();
        h.setName("House " + rnd.nextInt(1000));
        h.setAddress("Avenue " + rnd.nextInt(1, 200));
        h.setOwner(owners.get(rnd.nextInt(owners.size())));

        houseRepository.save(h);
        return h;
    }

    private Duplex createDuplex(List<Owner> owners) {

        ThreadLocalRandom rnd = ThreadLocalRandom.current();

        Duplex d = new Duplex();
        d.setName("Duplex " + rnd.nextInt(1000));
        d.setAddress("Road " + rnd.nextInt(1, 200));
        d.setOwner(owners.get(rnd.nextInt(owners.size())));

        duplexRepository.save(d);
        return d;
    }

    private TownHouse createTownHouse(List<Owner> owners) {

        ThreadLocalRandom rnd = ThreadLocalRandom.current();

        TownHouse t = new TownHouse();
        t.setName("TownHouse " + rnd.nextInt(1000));
        t.setAddress("Lane " + rnd.nextInt(1, 200));
        t.setOwner(owners.get(rnd.nextInt(owners.size())));

        townHouseRepository.save(t);
        return t;
    }

    // ============================
    // SCHOOLS
    // ============================
    private List<School> populateSchools(int qty) {

        List<School> schools = new ArrayList<>();
        ThreadLocalRandom rnd = ThreadLocalRandom.current();

        String[] types = {"public", "private", "religious"};
        String[] locations = {"Downtown", "Uptown", "Suburbs", "East Side", "West Side"};

        for (int i = 0; i < qty; i++) {

            School s = new School(
                    "School " + rnd.nextInt(1000),
                    "Address " + rnd.nextInt(1, 200),
                    types[rnd.nextInt(types.length)],
                    "Primary",
                    locations[rnd.nextInt(locations.length)],
                    rnd.nextInt(1, 5),
                    true
            );

            schoolRepository.save(s);
            schools.add(s);
        }

        return schools;
    }

    private void assignSchoolsToProperties(List<Property> properties, List<School> schools) {

        ThreadLocalRandom rnd = ThreadLocalRandom.current();

        for (Property p : properties) {

            int qty = rnd.nextInt(1, 4);

            for (int i = 0; i < qty; i++) {
                p.getNearbySchools().add(schools.get(rnd.nextInt(schools.size())));
            }

            if (p instanceof Apartment) apartmentRepository.save((Apartment) p);
            else if (p instanceof House) houseRepository.save((House) p);
            else if (p instanceof Duplex) duplexRepository.save((Duplex) p);
            else if (p instanceof TownHouse) townHouseRepository.save((TownHouse) p);
        }
    }

    // ============================
    // REVIEWERS
    // ============================
    private List<Reviewer> populateReviewers(int qty) {

        List<Reviewer> reviewers = new ArrayList<>();
        ThreadLocalRandom rnd = ThreadLocalRandom.current();

        String[] firstNames = {"John", "Jane", "Michael", "Sarah", "David", "Emily"};
        String[] lastNames = {"Smith", "Johnson", "Williams", "Brown", "Jones"};
        String[] phones = {"+34 600111222", "+34 600333444"};
        String[] domains = {"gmail.com", "yahoo.com"};

        for (int i = 0; i < qty; i++) {

            String fullName = firstNames[rnd.nextInt(firstNames.length)] + " " +
                    lastNames[rnd.nextInt(lastNames.length)];

            String email = fullName.toLowerCase().replace(" ", ".") + "@" +
                    domains[rnd.nextInt(domains.length)];

            Reviewer r = new Reviewer(
                    fullName,
                    LocalDate.now().minusYears(rnd.nextInt(18, 70)),
                    phones[rnd.nextInt(phones.length)],
                    email,
                    "password123",
                    true,
                    rnd.nextInt(0, 100),
                    rnd.nextBoolean(),
                    "x_" + rnd.nextInt(10000),
                    "https://site.com/" + fullName.replace(" ", "").toLowerCase(),
                    rnd.nextInt(0, 50)
            );

            reviewerRepository.save(r);
            reviewers.add(r);
        }

        return reviewers;
    }

    // ============================
    // REVIEWS
    // ============================
    private List<Review> populateReviews(int qty, List<Reviewer> reviewers, List<Property> properties) {

        List<Review> reviews = new ArrayList<>();
        ThreadLocalRandom rnd = ThreadLocalRandom.current();

        String[] titles = {"Great place", "Not bad", "Could be better", "Excellent", "Terrible"};
        String[] contents = {"Good experience", "Average", "Bad experience", "Loved it", "Not recommended"};

        for (int i = 0; i < qty; i++) {

            Review r = new Review(
                    titles[rnd.nextInt(titles.length)],
                    contents[rnd.nextInt(contents.length)],
                    rnd.nextInt(1, 5),
                    LocalDate.now().minusDays(rnd.nextInt(0, 365)),
                    null,
                    null
            );

            Reviewer reviewer = reviewers.get(rnd.nextInt(reviewers.size()));
            Property property = properties.get(rnd.nextInt(properties.size()));

            r.setReviewer(reviewer);
            r.setProperty(property);

            reviewRepository.save(r);
            reviews.add(r);
        }

        return reviews;
    }

    // ============================
    // CONTRACTS
    // ============================
    private List<PropertyContract> populateContracts(int qty, List<Owner> owners, List<Property> properties) {

        List<PropertyContract> contracts = new ArrayList<>();
        ThreadLocalRandom rnd = ThreadLocalRandom.current();

        String[] names = {"Standard Contract", "Premium Contract", "Short Lease", "Long Lease"};
        String[] details = {"Basic terms", "Extended terms", "Short duration", "Long duration"};

        for (int i = 0; i < qty; i++) {

            Owner owner = owners.get(rnd.nextInt(owners.size()));
            Property property = properties.get(rnd.nextInt(properties.size()));

            PropertyContract c = new PropertyContract(
                    names[rnd.nextInt(names.length)],
                    details[rnd.nextInt(details.length)],
                    rnd.nextDouble(500, 5000),
                    LocalDate.now().minusDays(rnd.nextInt(0, 365)),
                    owner,
                    property
            );

            c.setEndDate(c.getStartDate().plusDays(rnd.nextInt(30, 365)));

            propertyContractRepository.save(c);
            contracts.add(c);
        }

        return contracts;
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/utils/ApartmentJsonWriter.java
----------------------------------------
package com.example.apartment_predictor.utils;

import com.example.apartment_predictor.model.Apartment;
import com.fasterxml.jackson.databind.ObjectMapper;
import java.io.File;
import java.util.List;

public class ApartmentJsonWriter {

    public static void writeToFile(List<Apartment> apartments) {
        try {
            ObjectMapper mapper = new ObjectMapper();
            mapper.writerWithDefaultPrettyPrinter()
                    .writeValue(new File("apartments.json"), apartments);

            System.out.println("Archivo apartments.json generado correctamente");
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}

----------------------------------------
Archivo: /home/oscar/Oscar/CursoAplicacionesWeb/MyProjects/ApartmentPredictor/src/main/java/com/example/apartment_predictor/utils/PrintingUtils.java
----------------------------------------
package com.example.apartment_predictor.utils;

import com.example.apartment_predictor.model.Apartment;
import com.example.apartment_predictor.repository.ApartmentRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.repository.CrudRepository;
import org.springframework.stereotype.Component;

import java.util.List;

@Component
public class PrintingUtils {
    @Autowired
    private ApartmentRepository apartmentRepository;

    public static void printList(List list) {
        for (Object obj : list) {
            System.out.println(obj);
        }
    }

    public static void printList(List list, String title) {
        System.out.println("\n=== " + title + " ===");
        for (Object obj : list) {
            System.out.println(obj);
        }
    }

    public static void printApartments(CrudRepository apartmentRepository) {
        // Display all apartments in the database
        int index = 0;
        System.out.println("\n=== Apartments in the Database ===");
        for (Object apartment : apartmentRepository.findAll()) {
            index++;
            System.out.println("#" + index);
            System.out.println(apartment);
        }
    }

    public static void printApartmentsList(Iterable<Apartment> apartments) {
        // Display all apartments in the database
        int index = 0;
        System.out.println("\n=== Apartments in the Database ===");
        for (Apartment apartment : apartments) {
            index++;
            System.out.println("#" + index);
            System.out.println(apartment);
        }
    }

    public static void printObjectsList(Iterable<?> list) {
        // Display all apartments in the database
        int index = 0;
        System.out.println("\n=== Apartments in the Database ===");
        for (Object obj : list) {
            index++;
            System.out.println("#" + index);
            System.out.println(obj);
        }
    }

    public void printApartmentsByRepoInstance() {
        // Display all apartments in the database
        int index = 0;
        System.out.println("\n=== Apartments in the Database ===");
        for (Apartment apartment : apartmentRepository.findAll()) {
            index++;
            System.out.println("#" + index);
            System.out.println(apartment);
        }
    }

   /*public static void printApartmentsByRepo(){
    // Display all apartments in the database
    int index = 0;
    System.out.println("\n=== Apartments in the Database ===");
    for (Apartment apartment : apartmentRepository.findAll()) {
        index++;
        System.out.println("#" + index);
        System.out.println(apartment);
        int nil = 10;
    }
   }*/

}

===== application.properties =====

spring.application.name=ApartmentPredictor

# URL de la bd H2 en modo archivo (relativa al proyecto)
spring.datasource.url=jdbc:h2:file:./db/apartmentpredictordb
#spring.datasource.url=jdbc:h2:/home/oscar/MyProjects/ApartmentPredictor/db/apartmentpredictordb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=oscar
spring.datasource.password=1234

spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# Ruta relativa desde la raiz del proyecto
app.csv.path=db/Housing.csv
app.reviews.csv.path=db/Reviews.csv
#app.populate-on-start=false
app.populate-on-start=true


spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update

===== pom.xml =====

<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">

    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.2.0</version>
        <relativePath/>
    </parent>

    <groupId>com.example</groupId>
    <artifactId>apartment-predictor</artifactId>
    <version>0.0.1-SNAPSHOT</version>

    <properties>
        <java.version>21</java.version>
    </properties>

    <repositories>
        <repository>
            <id>central</id>
            <url>https://repo.maven.apache.org/maven2</url>
        </repository>
    </repositories>

    <dependencies>

        <!-- Spring Boot -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <!-- H2 -->
        <dependency>
            <groupId>com.h2database</groupId>
            <artifactId>h2</artifactId>
            <scope>runtime</scope>
        </dependency>

        <!-- DataFaker -->
        <dependency>
            <groupId>net.datafaker</groupId>
            <artifactId>datafaker</artifactId>
            <version>2.3.1</version>
        </dependency>

        <!-- Test -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>

    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <source>21</source>
                    <target>21</target>
                </configuration>
            </plugin>
        </plugins>
    </build>

</project>